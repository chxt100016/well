#parse("sys/creditorheader.html")
<head>
    <title></title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/semantic-ui/2.2.4/semantic.min.css">
    <script src="http://libs.baidu.com/jquery/1.9.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/semantic-ui/2.2.4/semantic.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.1.3/vue.js"></script>
    <script src="${rc.contextPath}/statics/libs/ajaxupload.js">    </script>
    <style>
        .file {
            position: relative;
            display: inline-block;
            background: #21BA45;
            border: 1px solid #21BA45;
            border-radius: 4px;
            padding: 4px 12px;
            overflow: hidden;
            color: #FFF;
            text-decoration: none;
            text-indent: 0;
            line-height: 20px;
        }

        .file input {
            position: absolute;
            font-size: 100px;
            right: 0;
            top: 0;
            opacity: 0;
        }

        .file:hover {
            /* /* background: #AADFFD;
            border-color: #78C3F3; */
            color: #004974; 
            text-decoration: none;
            cursor: pointer
        }

        .white {
            color: #fff
        }

        .excel-inco {
            font-size: 25px !important;
            width: 45px !important;
            background: #fff;
            border: none;
            color: green;
            float: right;
            margin-top: -25px !important;
        }
        .ui.card{
            overflow: hidden;
        }
        .ui.card>.content p, .ui.cards>.card>.content p{
            width: 100%;
            text-overflow: ellipsis !important;
            overflow: hidden;white-space: nowrap;text-overflow: ellipsis; 
        }
    </style>
</head>

<body>
    <div class="ui container segment" id="app1" style="width:990px">
        <h3>放贷资格申请</h3>
        <div class="ui divider"></div>
        <form class="ui form segment" >
            <div class="ui three column grid">
                <br>
                <h4 style="text-indent:1em">资料提交：（请上传贵公司近三年的以下资料）</h4>
                <div class="row">
                    <div class=" ui cards">
                        <div class="card" style=" margin-left: 24px;">
                            <div class="content">
                                <div class="header">
                                    利润表
                                </div>
                                <div class="description" >
                                    请上传压缩文件
                                </div>

                            </div>
                            <div class="extra content field">
                                <div class="meta" style=" height: 35px">
                                    无文件

                                </div>
                                <a href="javascript:;" class="file">
                                         <span class="white">选择文件</span>
                                          <i class="upload icon white" ></i>
                                         <input type="file" name="" id="upload1">
                                         <input type="hidden" name="income">
                                    </a>

                            </div>

                        </div>
                        <div class="card">
                            <div class="content">
                                <div class="header">
                                    资产负债表
                                </div>
                                <div class="description">
                                    请上传压缩文件
                                </div>

                            </div>
                            <div class="extra content field">
                                <div class="meta" style=" height: 35px">
                                    无文件

                                </div>
                                <a href="javascript:;" class="file">
                                         <span class="white">选择文件</span>
                                          <i class="upload icon white" ></i>
                                         <input type="file" name="" id="upload2" >
                                         <input type="hidden" name="liabilities">
                                    </a>

                            </div>

                        </div>
                        <div class="card">
                            <div class="content">
                                <div class="header">
                                    现金流量表
                                </div>
                                <div class="description">
                                    请上传压缩文件
                                </div>

                            </div>
                            <div class="extra content field">
                                <div class="meta" style=" height: 35px">
                                    无文件

                                </div>
                                <a href="javascript:;" class="file">
                                                <span class="white">选择文件</span>
                                                <i class="upload icon white" ></i>
                                                <input type="file" name="" id="upload3" >
                                                <input type="hidden" name="cashFlow">
                                            </a>

                            </div>

                        </div>




                    </div>
                </div>
                <div class="row">
                    <h4 style="width:100%;text-indent:2em">资质提交：</h4>
                    <div class=" ui cards">
                        <div class="card" style=" margin-left: 24px;">
                            <div class="content">
                                <div class="header">
                                   纳税表
                                </div>
                                <div class="description">
                                    请上传压缩文件
                                </div>

                            </div>
                            <div class="extra content field">
                                <div class="meta" style=" height: 35px">
                                    无文件

                                </div>
                                <a href="javascript:;" class="file">
                                                <span class="white">选择文件</span>
                                                <i class="upload icon white" ></i>
                                                <input type="file" name="" id="upload4" >
                                                <input type="hidden" name="tax">
                                </a>

                            </div>

                        </div>
                         <div class="card" style=" margin-left: 24px;">
                            <div class="content">
                                <div class="header">
                                   金融资质文件
                                </div>
                                <div class="description">
                                    请上传压缩文件
                                </div>

                            </div>
                            <div class="extra content field">
                                <div class="meta" style=" height: 35px">
                                    无文件

                                </div>
                                <a href="javascript:;" class="file">
                                                <span class="white">选择文件</span>
                                                <i class="upload icon white" ></i>
                                                <input type="file" name="" id="upload6" >
                                                <input type="hidden" name="qualifition">
                                </a>

                            </div>

                        </div>
                         <div class="card" >
                            <div class="content">
                                <div class="header">
                                   其他
                                </div>
                                <div class="description">
                                    请上传压缩文件
                                </div>

                            </div>
                            <div class="extra content field">
                                <div class="meta" style=" height: 35px">
                                    无文件

                                </div>
                                <a href="javascript:;" class="file">
                                                <span class="white">选择文件</span>
                                                <i class="upload icon white" ></i>
                                                 <input type="file" name="" id="upload5" >
                                                <input type="hidden" name="other1">
                                </a>

                            </div>

                        </div>
                    </div>

                </div>

            </div>

            <br>
            <div class="ui primary submit button">提交申请</div>

        </form>

    </div>


</body>
<script>
    $(function () { 
        new AjaxUpload('#upload1', {
                    action: '${rc.contextPath}/uploadFile',
                    name: 'file',
                    autoSubmit:true,
                    responseType:"json",
                    onSubmit:function(file, extension){
                        if (!(extension && /^(zip|tar|rar)$/.test(extension.toLowerCase()))){
                            alert('只支持zip、tar、rar格式的文件！');
                            return false;
                        }
                    },
                    onComplete : function(file, data){
                        if(data.result=="-10") { ShowWindowAlert("提示",data.msg,"","确 定",""); return; }
                        $(":input[name='income'][type='hidden']").val(data.path);
                        /*$("a#bankBill").attr("href",data.path);*/
                        handleFiles(document.getElementById("upload1"),file);
                        return;
                    }
                });
                new AjaxUpload('#upload2', {
                    action: '/wellassist/uploadFile',
                    name: 'file',
                    autoSubmit:true,
                    responseType:"json",
                    onSubmit:function(file, extension){
                        if (!(extension && /^(zip|tar|rar)$/.test(extension.toLowerCase()))){
                            alert('只支持zip、tar、rar格式的文件！');
                            return false;
                        }
                    },
                    onComplete : function(file, data){
                        if(data.result=="-10") { ShowWindowAlert("提示",data.msg,"","确 定",""); return; }
                        $(":input[name='liabilities'][type='hidden']").val(data.path);
                        handleFiles(document.getElementById("upload2"),file);
                        return;
                    }
                });
                new AjaxUpload('#upload3', {
                    action: '/wellassist/uploadFile',
                    name: 'file',
                    autoSubmit:true,
                    responseType:"json",
                    onSubmit:function(file, extension){
                        if (!(extension && /^(zip|tar|rar)$/.test(extension.toLowerCase()))){
                            alert('只支持zip、tar、rar格式的文件！');
                            return false;
                        }
                    },
                    onComplete : function(file, data){
                        if(data.result=="-10") { ShowWindowAlert("提示",data.msg,"","确 定",""); return; }
                        $(":input[name='cashFlow'][type='hidden']").val(data.path);
                        handleFiles(document.getElementById("upload3"),file);
                        return;
                    }
                });
                new AjaxUpload('#upload4', {
                    action: '/wellassist/uploadFile',
                    name: 'file',
                    autoSubmit:true,
                    responseType:"json",
                    onSubmit:function(file, extension){
                        if (!(extension && /^(zip|tar|rar)$/.test(extension.toLowerCase()))){
                            alert('只支持zip、tar、rar格式的文件！');
                            return false;
                        }
                    },
                    onComplete : function(file, data){
                        if(data.result=="-10") { ShowWindowAlert("提示",data.msg,"","确 定",""); return; }
                        $(":input[name='tax'][type='hidden']").val(data.path);
                        handleFiles(document.getElementById("upload4"),file);
                        return;
                    }
                });
                 new AjaxUpload('#upload5', {
                    action: '/wellassist/uploadFile',
                    name: 'file',
                    autoSubmit:true,
                    responseType:"json",
                    onSubmit:function(file, extension){
                        if (!(extension && /^(zip|tar|rar)$/.test(extension.toLowerCase()))){
                            alert('只支持zip、tar、rar格式的文件！');
                            return false;
                        }
                    },
                    onComplete : function(file, data){
                        if(data.result=="-10") { ShowWindowAlert("提示",data.msg,"","确 定",""); return; }
                        $(":input[name='other1'][type='hidden']").val(data.path);
                        handleFiles(document.getElementById("upload5"),file);
                        return;
                    }
                });
                new AjaxUpload('#upload6', {
                    action: '/wellassist/uploadFile',
                    name: 'file',
                    autoSubmit:true,
                    responseType:"json",
                    onSubmit:function(file, extension){
                        if (!(extension && /^(zip|tar|rar)$/.test(extension.toLowerCase()))){
                            alert('只支持zip、tar、rar格式的文件！');
                            return false;
                        }
                    },
                    onComplete : function(file, data){
                        if(data.result=="-10") { ShowWindowAlert("提示",data.msg,"","确 定",""); return; }
                        $(":input[name='qualifition'][type='hidden']").val(data.path);
                        handleFiles(document.getElementById("upload6"),file);
                        return;
                    }
                });
        $('.ui.form').form({
            fields: {
                
                income: {
                    identifier: 'income',
                    rules: [
                        {
                            type: 'empty',
                            prompt: '请上传利润表'
                        }
                    ]

                },

                liabilities: {
                    identifier: 'liabilities',
                    rules: [
                        {
                            type: 'empty',
                            prompt: '请上传资产负债表'
                        }
                    ]

                },
                cashFlow: {
                    identifier: 'cashFlow',
                    rules: [
                        {
                            type: 'empty',
                            prompt: '请上传现金流量表'
                        }
                    ]

                },
                tax: {
                    identifier: 'tax',
                    rules: [
                        {
                            type: 'empty',
                            prompt: '请上传纳税表'
                        }
                    ]

                },
                qualifition: {
                    identifier: 'qualifition',
                    rules: [
                        {
                            type: 'empty',
                            prompt: '请上传金融资质文件'
                        }
                    ]

                }

            },
            inline: true,
            on: 'blur',
            onSuccess: valided

        });
        function valided(){
            var  $form = $('.form'),allFields = $form.form('get values');
            console.log(allFields);
            console.log("验证无误可以提交");
            // $.post('${rc.contextPath}/creditor/creditorAuthApply',allFields,function(r){
            //    if(r.code==0){
            //        window.location.href="${rc.contextPath}/creditor/creditorAuthApply";
            //    }else{
            //        alert(r.msg);
            //    }
            // },'json');
               $.ajax({  
                    type : "post",  //提交方式  
                    url : '${rc.contextPath}/creditor/creditorAuthApply',//路径
                    dataType:'json',
                    contentType:'application/json',
                    data : JSON.stringify(allFields),
                    //数据，这里使用的是Json格式进行传输  
                    success : function(result) {//返回数据根据结果进行相应的处理  
                        if ( result.code ==0 ) {
                            window.location.href="${rc.contextPath}/creditor/qualityApplySuccess";
                        } else {  
                            alert(result.msg);
                        }
                    }  
                }); 
        };
      $('.ui.form').submit(function(e){ 
    //e.preventDefault(); usually use this, but below works best here.
    return false;
});
      
   

    function handleFiles(files,filename) {
        var filesShow = files.parentNode.parentNode.firstChild.nextElementSibling;

        if (!filename) {
  console.log('null')
        }
        else {
            filesShow.innerHTML = "<p>" + filename + "</p>" + '<i class="file outline icon excel-inco ">' + '</i>';

        }
        console.log(filesShow)
        console.log(files.value)
    }

     })
</script>

</html>