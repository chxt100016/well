<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.wella.front.seller.mapper.SellerOrderMapper">

	<!-- 获取商品列表 -->
	<select id="getWaProdList" parameterType="java.util.Map" resultType="java.util.Map">
		SELECT *
			FROM wa_prod as a
			WHERE a.user_id = #{userId} and a.prod_state !=-3
			<if test="prodState!=null and prodState!=''">
				AND a.prod_state = #{prodState} 
			</if>

			ORDER BY a.prod_id DESC
			LIMIT ${start} , ${size}
	</select>
	
	<select id="getWaProdListCount" parameterType="java.util.Map" resultType="int">
		SELECT count(*)
		FROM wa_prod as a
		WHERE a.user_id = #{userId} and a.prod_state !=-3
		<if test="prodState!=null and prodState!=''">
			AND a.prod_state = #{prodState}
		</if>
	</select>
	
	<!-- 获取订单列表 -->
	<select id="getWaOrderList" parameterType="java.util.Map" resultType="java.util.Map">
		SELECT a.order_id, a.order_no, a.prod_id, a.sale_num, a.sale_money, a.sale_sj_num, a.sale_sj_money, a.order_state, a.order_date, b.prod_name, b.prod_img
			FROM wa_order as a INNER JOIN wa_prod as b ON a.prod_id = b.prod_id
			WHERE a.supplier_id = #{userId} and a.order_state > -1
			<if test="orderState!=null and orderState!=''">
				AND a.order_state = #{orderState} 
			</if>
			ORDER BY a.order_id DESC
			LIMIT ${start} , ${size}
	</select>
	
	<select id="getWaOrderListCount" parameterType="java.util.Map" resultType="int">
		SELECT count(*) 
			FROM wa_order as a INNER JOIN wa_prod as b ON a.prod_id = b.prod_id
			WHERE a.supplier_id = #{userId} and a.order_state > -1
			<if test="orderState!=null and orderState!=''">
				AND a.order_state = #{orderState} 
			</if>
	</select>

        <!--  -->
	<select id="getEstiList" parameterType="java.util.Map" resultType="java.util.Map">
		SELECT order_id, order_no, prod_id, prod_name, sale_sj_num, sale_sj_money, pj_state, pj_date, pj_content 
			FROM wa_order as a
			WHERE a.supplier_id = #{userId} and a.order_state = 7
			<if test="pjState!=null and pjState!=''">
				AND a.pj_state = #{pjState} 
			</if>
			ORDER BY a.order_id DESC
			LIMIT ${start} , ${size}
	</select>
	
	<select id="getEstiListCount" parameterType="java.util.Map" resultType="int">
		SELECT count(*) 
			FROM wa_order as a
			WHERE a.supplier_id = #{userId} and a.order_state = 7
			<if test="pjState!=null and pjState!=''">
				AND a.pj_state = #{pjState} 
			</if>
	</select>
	
	<!--  -->
	<select id="getUserOrderList" parameterType="java.util.Map" resultType="java.util.Map">
		SELECT a.order_id, a.sale_sj_num, a.sale_sj_money, a.pj_date, a.pj_state, b.company_name, b.zc_region_id 
			FROM wa_order as a INNER JOIN wa_userinfo as b ON a.user_id = b.user_id
			WHERE a.supplier_id = #{userId} and a.order_state = 7
			<if test="pjDay!=null and pjDay!=''">
				AND DATE_ADD(a.pj_date,INTERVAL ${pjDay} DAY) >= CURDATE() 
			</if>
			<if test="companyName!=null and companyName!=''">
				AND b.company_name like '%${companyName}%' 
			</if>
			ORDER BY a.order_id DESC
			LIMIT ${start} , ${size}
	</select>
	
	<select id="getUserOrderListCount" parameterType="java.util.Map" resultType="int">
		SELECT count(*) 
			FROM wa_order as a INNER JOIN wa_userinfo as b ON a.user_id = b.user_id
			WHERE a.supplier_id = #{userId} and a.order_state = 7
			<if test="pjDay!=null and pjDay!=''">
				AND DATE_ADD(a.pj_date,INTERVAL ${pjDay} DAY) >= CURDATE() 
			</if>
			<if test="companyName!=null and companyName!=''">
				AND b.company_name like '%${companyName}%' 
			</if>
	</select>
</mapper>