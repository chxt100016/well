<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.wella.front.customer.mapper.CustomerLoginMapper">
					
	<select id="get_user_count" parameterType="java.util.Map"  resultType = "java.util.Map"  >
		SELECT COUNT(*) cn FROM wa_user where user_account like #{company_name}
	</select>

	<select id="getMenuList" parameterType="java.util.Map" 	resultType="java.util.Map">
		<choose>
			<when test="userType==0">
				SELECT * FROM zh_menu WHERE parent_id = #{parentId}
				and user_type=6 order by order_num
			</when>
			<when test="userType==-1">
				SELECT * FROM zh_menu WHERE parent_id > 0 and menu_id
				in (${permission}) order by order_num
			</when>
			<otherwise>
				SELECT * FROM zh_menu WHERE parent_id = #{parentId} and
				menu_id in (${permission}) order by order_num
			</otherwise>
		</choose>
	</select>

	<select id="getMenuByUser" parameterType="java.util.Map"
		resultType="java.util.Map">
		SELECT GROUP_CONCAT(CAST( menu_id AS CHAR )) as menu FROM zh_menu WHERE
		user_type = #{userType}
	</select>
	
	<insert id="insertWaUser" parameterType="java.util.Map">
		insert into wa_user set user_type = #{user_type}, create_date=NOW(), user_pass = #{user_pass}, user_email = #{user_email}, user_phone = #{user_phone}, user_reg_no = #{user_reg_no},user_name = #{user_name} 
		<selectKey keyProperty="newId" resultType="String">
		select last_insert_id()
		</selectKey>
	</insert>
	
	<insert id="insertWaUserInfo" parameterType="java.util.Map">
		insert into wa_userinfo set company_type = #{company_type}, 
			user_id = #{info_userId}, 
			sp_type = #{sp_type}, 
			company_name = #{company_name}, 
			company_yy_zz_img = #{company_yy_zz_img},
			company_xkz_img = #{company_xkz_img}, 
			company_txkz_img = #{company_txkz_img},
			company_yy_zz = #{company_yy_zz},
			company_kh_xkz = #{company_kh_xkz},
			company_txkz = #{company_txkz},
			zc_region_id = #{zc_region_id},
			zc_xx_address = #{zc_xx_address},
			company_lxr = #{company_lxr},
			company_lxr_phone = #{company_lxr_phone}
	</insert>

</mapper>
