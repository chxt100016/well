<?xml version="1.0" encoding="UTF-8" ?> 
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd"> 

<mapper namespace="org.wella.houtai.jygl.mapper.HoutaiJyglUserMoneyMapper">
  	<!-- select -->
  	<!-- 交易目录获得函数 -->
	<select id = "getJyList" parameterType="java.util.Map" resultType = "java.util.Map">
	   SELECT a.* , b.user_name , c.company_img
		FROM wa_user_money a 
		INNER JOIN wa_user b ON a.user_id = b.user_id 
		INNER JOIN wa_userinfo c ON a.user_id = c.user_id 
		<where>
			a.jy_state >= 0
			<if test = "userName != null">
				AND b.user_name LIKE '%${userName}%'		
			</if>
			<if test = "jyType != null">
				AND a.jy_type = #{jyType}	
			</if>
			<if test = "startJyDate != null">
				AND a.jy_date >= ${startJyDate}		
			</if>
			<if test = "endJyDate != null">
				AND a.jy_date &lt;= ${endJyDate}		
			</if>
		</where>	
		ORDER BY a.money_id DESC
		LIMIT ${start}, ${size}    
	</select>
	
	<!-- 交易目录个数获得函数 -->
	<select id = "getJyListCount" parameterType="java.util.Map" resultType = "int">
	   SELECT COUNT(*) 
		FROM wa_user_money a 
		INNER JOIN wa_user b ON a.user_id = b.user_id 
		<where>
			a.jy_state >= 0
			<if test = "userName != null">
				AND b.user_name LIKE '%${userName}%'		
			</if>
			<if test = "jyType != null">
				AND a.jy_type = #{jyType}	
			</if>
			<if test = "startJyDate != null">
				AND a.jy_date >= ${startJyDate}		
			</if>
			<if test = "endJyDate != null">
				AND a.jy_date &lt;= ${endJyDate}		
			</if>
		</where>	
	</select>
	
	<!-- 交易信息获得函数 -->
	<select id = "getJyDetailInfo" parameterType="java.util.Map" resultType = "java.util.Map">
	   SELECT a.* , b.user_name , c.company_img
		FROM wa_user_money a 
		INNER JOIN wa_user b ON a.user_id = b.user_id 
		INNER JOIN wa_userinfo c ON a.user_id = c.user_id 
		<where>
			<if test = "moneyId != null">
				AND a.money_id = #{moneyId}		
			</if>
		</where>	
	</select>
	
	 
</mapper>